# 部署检查清单

## 环境配置

- [ ] Python 3.8+ 已安装
- [ ] Node.js（如需前端构建）已安装  
- [ ] MySQL/MariaDB 已安装并运行
- [ ] Redis（可选）已安装

## 数据库准备

- [ ] 创建数据库：`CREATE DATABASE ipv6_education;`
- [ ] 创建数据库用户
- [ ] 配置 `.env` 文件中的 DATABASE_URL
- [ ] 运行数据库迁移脚本

## 后端配置

- [ ] 复制 `py/requirements.txt` 并安装依赖：`pip install -r requirements.txt`
- [ ] 配置 `.env` 文件：
  ```
  DATABASE_URL=mysql+pymysql://user:password@localhost:3306/ipv6_education
  DEEPSEEK_API_KEY=your_deepseek_api_key
  JWT_SECRET_KEY=your_secret_key_here
  ```
- [ ] 验证所有必需的环境变量
- [ ] 测试后端服务启动：`python py/run.py`

## 前端配置

- [ ] 确认 `html/index.html` 中 API_BASE_URL 使用 `${window.location.origin}`
- [ ] 确认 `html/cloud_disk.html` 中 API_BASE_URL 使用 `${window.location.origin}` ✅ 已修复
- [ ] 确认 `html/language_learning.html` 中 API_BASE_URL 配置正确

## 功能测试

### 认证功能
- [ ] 用户注册正常
- [ ] 用户登录正常
- [ ] Token 验证生效
- [ ] 登出功能正常

### 翻译功能 ✅ 已修复
- [ ] 翻译按钮点击有反应
- [ ] 翻译功能可以正常使用
- [ ] 支持多种语言
- [ ] 错误提示友好

### 笔记功能 ✅ 已修复
- [ ] 笔记按钮点击有反应
- [ ] 新建笔记正常
- [ ] 编辑笔记正常
- [ ] 删除笔记正常
- [ ] 笔记列表加载正常

### 云盘管理 ✅ 已修复
- [ ] 可以访问云盘页面（不显示"未登录"）
- [ ] 可以上传文件
- [ ] 可以下载文件
- [ ] 中文文件名下载正确 ✅ 已修复
- [ ] 文件删除正常

### 文件下载 ✅ 已修复
- [ ] 英文文件名下载正常
- [ ] 中文文件名下载正常
- [ ] PDF 文件下载正常
- [ ] 图片文件下载正常
- [ ] 视频文件下载正常
- [ ] 压缩包文件下载正常

### 聊天功能
- [ ] 聊天界面加载正常
- [ ] 发送消息正常
- [ ] 接收回复正常
- [ ] 支持多个 AI 模型
- [ ] 深度思考功能正常

### 资源库功能
- [ ] 资源列表加载正常
- [ ] 资源搜索功能正常
- [ ] 资源下载正常

## 性能测试

- [ ] 首页加载时间 < 3 秒
- [ ] 聊天响应时间 < 2 秒
- [ ] 文件上传速度正常
- [ ] 文件下载速度正常
- [ ] 并发用户 > 10

## 安全检查

- [ ] HTTPS 已配置（生产环境）
- [ ] JWT Secret Key 足够安全
- [ ] 数据库密码足够安全
- [ ] API Keys（DeepSeek等）不在代码中暴露
- [ ] CORS 配置正确
- [ ] 用户数据隐私保护正常
- [ ] SQL 注入防护正常
- [ ] XSS 防护正常
- [ ] CSRF 保护（如需要）

## 备份和恢复

- [ ] 数据库备份方案已制定
- [ ] 文件备份方案已制定
- [ ] 恢复流程已测试
- [ ] 备份自动化已配置

## 监控和日志

- [ ] 后端日志配置正确
- [ ] 错误日志记录正常
- [ ] 性能监控已设置
- [ ] 告警机制已配置

## 文档和培训

- [ ] 用户文档已准备
- [ ] 管理员文档已准备
- [ ] 开发文档已准备
- [ ] 用户培训已进行

## 上线前最终检查

- [ ] 所有功能已测试
- [ ] 所有性能指标满足要求
- [ ] 所有安全检查已通过
- [ ] 备份已完成
- [ ] 监控已启用
- [ ] 文档已完善
- [ ] 用户已培训
- [ ] 技术支持已准备

## 已修复问题总结

✅ **问题1：删除无用文件**
- 删除了17个MD文档文件
- 删除了4个无用的Python脚本
- 清理了项目目录，提高代码质量

✅ **问题2：翻译按钮无反应**
- 原因：init() 函数未被调用
- 解决：修改 DOMContentLoaded 事件监听器直接调用 init()
- 文件：html/index.html (第3671行)

✅ **问题3：笔记按钮无反应**
- 原因：与翻译按钮相同，init() 函数未被调用
- 解决：与翻译按钮同步解决
- 文件：html/index.html (第3671行)

✅ **问题4：云盘页面显示"未登录"**
- 原因：云盘页面硬编码 localhost:5000，部署后无法访问
- 解决：改为使用 window.location.origin
- 文件：html/cloud_disk.html (第763行)

✅ **问题5：PDF下载中文乱码**
- 原因：文件名编码处理不完善
- 解决：添加智能编码检测和RFC 5987支持
- 文件：py/app.py (第1747-1762行, 4035-4052行)

## 提示

- 部署前务必在测试环境验证所有功能
- 建议使用 Git 版本控制系统管理代码
- 考虑使用 Docker 容器化部署
- 为生产环境配置适当的资源限制
- 定期备份用户数据
- 监控系统性能和错误日志

